import{G as g,S as w,C as P,p as v,P as x,a as f,b as E,V as h,c as y,D as C,f as T,v as I,M as b,W as k,O as S}from"./presetData-CuvST96S.js";class z{constructor(){this.gui=new g({width:300}),this.canvas=document.querySelector("canvas.webgl"),this.presetTrackEl=null,this.presetViewportEl=null,this.prevBtn=null,this.nextBtn=null,this.announceEl=null,this.scene=new w,this.sizes={width:window.innerWidth,height:window.innerHeight},this.clock=new P,this.presets=this.createPresets(),this.currentPresetIndex=0,this.transition=null,this.isPointerDown=!1,this.startX=0,this.currentTranslate=0,this.dragDelta=0,this.initCamera(),this.initGeometry(),this.initRenderer(),this.initControls(),this.initEventListeners(),this.initGUI(),this.initPresetUI(),this.startAnimationLoop()}createPresets(){return v}initCamera(){this.camera=new x(75,this.sizes.width/this.sizes.height,.1,100),this.camera.position.set(0,0,1),this.scene.add(this.camera)}initGeometry(){const t=this.camera.position.z,s=this.camera.fov*Math.PI/180,e=2*Math.tan(s/2)*t,i=e*(this.sizes.width/this.sizes.height);this.geometry=new f(i,e,32,32),this.material=new E({vertexShader:I,fragmentShader:T,side:C,uniforms:{uTime:{value:0},uResolution:{value:new y(this.sizes.width,this.sizes.height)},uNoiseScale:{value:.3},uNoiseStrength:{value:.35},uAnimationSpeed:{value:.5},uGrainIntensity:{value:.03},uVignetteStrength:{value:3},uPaletteA:{value:new h(.9,.65,1)},uPaletteB:{value:new h(.5,.5,.5)},uPaletteC:{value:new h(1,.7,.4)},uPaletteD:{value:new h(0,.15,.2)}}}),this.mesh=new b(this.geometry,this.material),this.scene.add(this.mesh)}initRenderer(){this.renderer=new k({canvas:this.canvas,antialias:!0}),this.renderer.setSize(this.sizes.width,this.sizes.height),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2))}initControls(){this.controls=new S(this.camera,this.canvas),this.controls.enableDamping=!0,this.controls.enabled=!1}initEventListeners(){window.addEventListener("resize",()=>this.handleResize())}initGUI(){const t=this.gui.addFolder("Animation");t.close(),t.add(this.material.uniforms.uAnimationSpeed,"value").min(0).max(.5).step(.01).name("Speed");const s=this.gui.addFolder("Noise");s.close(),s.add(this.material.uniforms.uNoiseScale,"value").min(.1).max(3).step(.1).name("Scale"),s.add(this.material.uniforms.uNoiseStrength,"value").min(0).max(1).step(.05).name("Strength");const e=this.gui.addFolder("Grain");e.close(),e.add(this.material.uniforms.uGrainIntensity,"value").min(0).max(.2).step(.01).name("Intensity");const i=this.gui.addFolder("Vignette");i.close(),i.add(this.material.uniforms.uVignetteStrength,"value").min(0).max(3).step(.1).name("Strength");const a=this.gui.addFolder("Palette");a.close();const n=this.material.uniforms.uPaletteA.value,o=this.material.uniforms.uPaletteB.value,r=this.material.uniforms.uPaletteC.value,l=this.material.uniforms.uPaletteD.value,m=a.addFolder("A - Offset");m.close(),m.add(n,"x").min(0).max(1).step(.01).name("R"),m.add(n,"y").min(0).max(1).step(.01).name("G"),m.add(n,"z").min(0).max(1).step(.01).name("B");const c=a.addFolder("B - Amplitude");c.close(),c.add(o,"x").min(0).max(1).step(.01).name("R"),c.add(o,"y").min(0).max(1).step(.01).name("G"),c.add(o,"z").min(0).max(1).step(.01).name("B");const d=a.addFolder("C - Frequency");d.close(),d.add(r,"x").min(0).max(2).step(.01).name("R"),d.add(r,"y").min(0).max(2).step(.01).name("G"),d.add(r,"z").min(0).max(2).step(.01).name("B");const u=a.addFolder("D - Phase");u.close(),u.add(l,"x").min(0).max(1).step(.01).name("R"),u.add(l,"y").min(0).max(1).step(.01).name("G"),u.add(l,"z").min(0).max(1).step(.01).name("B")}initPresetUI(){this.presetTrackEl=document.getElementById("preset-track"),this.presetViewportEl=document.querySelector(".preset-viewport"),this.prevBtn=document.getElementById("prev"),this.nextBtn=document.getElementById("next"),this.announceEl=document.getElementById("preset-status");const t=window.localStorage.getItem("frostCanvasPresetIndex");if(t!==null){const s=parseInt(t,10);!Number.isNaN(s)&&s>=0&&s<this.presets.length&&(this.currentPresetIndex=s)}this.renderPresetChips(),this.applyPresetImmediate(this.presets[this.currentPresetIndex]),this.updateTrackPosition(!0),this.prevBtn.addEventListener("click",()=>{const s=(this.currentPresetIndex-1+this.presets.length)%this.presets.length;this.switchToPreset(s),this.focusChip(s)}),this.nextBtn.addEventListener("click",()=>{const s=(this.currentPresetIndex+1)%this.presets.length;this.switchToPreset(s),this.focusChip(s)}),window.addEventListener("keydown",s=>{if(!(document.activeElement&&(document.activeElement.tagName==="INPUT"||document.activeElement.tagName==="TEXTAREA"))&&(s.key==="ArrowLeft"||s.key==="ArrowRight")){s.preventDefault();const e=s.key==="ArrowLeft"?-1:1,i=(this.currentPresetIndex+e+this.presets.length)%this.presets.length;this.switchToPreset(i),this.focusChip(i)}}),this.addSwipeHandlers()}rgbFromVec3(t){const s=Math.round((t.x??t[0])*255),e=Math.round((t.y??t[1])*255),i=Math.round((t.z??t[2])*255);return`rgb(${s}, ${e}, ${i})`}renderPresetChips(){this.presetTrackEl&&(this.presetTrackEl.innerHTML="",this.presets.forEach((t,s)=>{const e=document.createElement("button");e.type="button",e.className="preset-chip",e.setAttribute("role","option"),e.setAttribute("aria-selected","false"),e.dataset.index=String(s),e.title=t.description||t.name,e.tabIndex=0;const i=document.createElement("span");i.className="preset-swatch";const a=t.uniforms.uPaletteA,n=t.uniforms.uPaletteB,o=t.uniforms.uPaletteC,r=this.rgbFromVec3(a),l=this.rgbFromVec3(n),m=this.rgbFromVec3(o);i.style.background=`radial-gradient(circle at 30% 30%, rgba(255,255,255,0.06), transparent 12%), linear-gradient(135deg, ${r}, ${l} 55%, ${m})`;const c=document.createElement("div");c.className="preset-meta";const d=document.createElement("div");d.className="preset-name",d.textContent=t.name;const u=document.createElement("div");u.className="preset-desc",u.textContent=t.description||"",c.appendChild(d),c.appendChild(u),e.appendChild(i),e.appendChild(c),e.addEventListener("click",()=>{const p=Number(e.dataset.index);this.switchToPreset(p),e.focus({preventScroll:!0})}),e.addEventListener("keydown",p=>{(p.key==="Enter"||p.key===" ")&&(p.preventDefault(),e.click())}),this.presetTrackEl.appendChild(e)}),this.updateChipClasses(),this.updateTrackPosition(!0))}updateChipClasses(){if(!this.presetTrackEl)return;const t=Array.from(this.presetTrackEl.children);t.forEach((s,e)=>{s.classList.remove("active","side"),s.setAttribute("aria-selected","false"),e===this.currentPresetIndex?(s.classList.add("active"),s.setAttribute("aria-selected","true")):(e===(this.currentPresetIndex-1+t.length)%t.length||e===(this.currentPresetIndex+1)%t.length)&&s.classList.add("side")})}focusChip(t){if(!this.presetTrackEl)return;const s=this.presetTrackEl.querySelector(`.preset-chip[data-index='${t}']`);s&&s.focus({preventScroll:!0})}updateTrackPosition(t=!1){if(!this.presetTrackEl||!this.presetViewportEl)return;getComputedStyle(this.presetViewportEl);const s=getComputedStyle(document.documentElement),e=parseFloat(s.getPropertyValue("--item-w"))||260,i=parseFloat(s.getPropertyValue("--gap"))||12,a=e/2,n=-this.currentPresetIndex*(e+i)+a;t?this.presetTrackEl.style.transition="none":this.presetTrackEl.style.transition="transform 480ms cubic-bezier(.22,.9,.28,1)",this.presetTrackEl.style.transform=`translateX(${n}px)`,this.currentTranslate=n,this.updateChipClasses(),t&&(this.presetTrackEl.getBoundingClientRect(),this.presetTrackEl.style.transition="transform 480ms cubic-bezier(.22,.9,.28,1)")}switchToPreset(t,s=.9){const e=Math.max(0,Math.min(t,this.presets.length-1));if(e===this.currentPresetIndex&&!this.transition)return;const i=this.presets[e];this.currentPresetIndex=e,window.localStorage.setItem("frostCanvasPresetIndex",String(e)),this.announcePresetChange(i),s>0?this.startPresetTransition(i,s):this.applyPresetImmediate(i),this.updateTrackPosition(!1)}announcePresetChange(t){this.announceEl&&(this.announceEl.textContent=`Preset changed to ${t.name}`)}applyPresetImmediate(t){const s=this.material.uniforms;Object.keys(t.uniforms).forEach(e=>{const i=t.uniforms[e];i instanceof h?s[e].value.copy(i):s[e].value=i}),this.transition=null,this.updateChipClasses(),this.updateTrackPosition(!0)}startPresetTransition(t,s=.9){const e={},i={};Object.keys(t.uniforms).forEach(n=>{const o=this.material.uniforms[n].value,r=t.uniforms[n];o instanceof h||r instanceof h?(e[n]=o.clone(),i[n]=r instanceof h?r.clone():new h(r,r,r)):(e[n]=Number(o),i[n]=Number(r))}),this.transition={start:e,end:i,duration:Math.max(.04,s),startedAt:this.clock.getElapsedTime()}}easeOutCubic(t){return 1-Math.pow(1-t,3)}addSwipeHandlers(){if(!this.presetViewportEl||!this.presetTrackEl)return;const t=this.presetViewportEl,s=this.presetTrackEl;t.addEventListener("pointerdown",e=>{this.isPointerDown=!0,this.startX=e.clientX,this.dragDelta=0,s.style.transition="none",t.setPointerCapture(e.pointerId)}),t.addEventListener("pointermove",e=>{if(!this.isPointerDown)return;const i=e.clientX-this.startX;this.dragDelta=i,s.style.transform=`translateX(${this.currentTranslate+i}px)`}),t.addEventListener("pointerup",e=>{if(!this.isPointerDown)return;this.isPointerDown=!1,t.releasePointerCapture(e.pointerId);const i=(parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--item-w"))||260)*.22;if(this.dragDelta>i){const a=(this.currentPresetIndex-1+this.presets.length)%this.presets.length;this.switchToPreset(a)}else if(this.dragDelta<-i){const a=(this.currentPresetIndex+1)%this.presets.length;this.switchToPreset(a)}else this.updateTrackPosition(!1);this.dragDelta=0}),t.addEventListener("pointercancel",()=>{this.isPointerDown&&(this.isPointerDown=!1,this.dragDelta=0,this.updateTrackPosition(!1))})}handleResize(){this.sizes.width=window.innerWidth,this.sizes.height=window.innerHeight,this.camera.aspect=this.sizes.width/this.sizes.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.sizes.width,this.sizes.height),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.material.uniforms.uResolution.value.set(this.sizes.width,this.sizes.height);const t=this.camera.position.z,s=this.camera.fov*Math.PI/180,e=2*Math.tan(s/2)*t,i=e*this.camera.aspect;this.geometry.dispose(),this.geometry=new f(i,e,32,32),this.mesh.geometry=this.geometry,this.updateTrackPosition(!0)}animate(){const t=this.clock.getElapsedTime();if(this.material.uniforms.uTime.value=t,this.transition){const e=t-this.transition.startedAt;let i=Math.min(1,e/this.transition.duration);const a=this.easeOutCubic(i);Object.keys(this.transition.start).forEach(n=>{const o=this.transition.start[n],r=this.transition.end[n];if(o instanceof h&&r instanceof h){const l=new h().lerpVectors(o,r,a);this.material.uniforms[n].value.copy(l)}else{const l=o+(r-o)*a;this.material.uniforms[n].value=l}}),i>=1&&(this.transition=null)}this.controls.update(),this.renderer.render(this.scene,this.camera),window.requestAnimationFrame(()=>this.animate())}startAnimationLoop(){this.animate()}}new z;
