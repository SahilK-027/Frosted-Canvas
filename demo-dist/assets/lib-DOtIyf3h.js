import{S as r,C as l,p as u,P as o,a as n,b as d,V as a,c as m,D as c,f as v,v as p,M as g,W as f,O as w,G as P}from"./presetData-CuvST96S.js";class y{constructor(e,t={}){if(this.container=typeof e=="string"?document.querySelector(e):e,!this.container)throw new Error("FrostCanvas: Container element not found");this.options={showGUI:t.showGUI??!1,showPresets:t.showPresets??!1,preset:t.preset??0,autoResize:t.autoResize??!0,...t},this.canvas=null,this.scene=new r,this.clock=new l,this.presets=u,this.currentPresetIndex=this.options.preset,this.transition=null,this.init()}init(){this.canvas=document.createElement("canvas"),this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",this.container.appendChild(this.canvas);const e=this.container.getBoundingClientRect();this.sizes={width:e.width,height:e.height},this.initCamera(),this.initGeometry(),this.initRenderer(),this.initControls(),this.options.autoResize&&this.initEventListeners(),this.options.showGUI&&this.initGUI(),this.applyPresetImmediate(this.presets[this.currentPresetIndex]),this.startAnimationLoop()}initCamera(){this.camera=new o(75,this.sizes.width/this.sizes.height,.1,100),this.camera.position.set(0,0,1),this.scene.add(this.camera)}initGeometry(){const e=this.camera.position.z,t=this.camera.fov*Math.PI/180,i=2*Math.tan(t/2)*e,s=i*(this.sizes.width/this.sizes.height);this.geometry=new n(s,i,32,32),this.material=new d({vertexShader:p,fragmentShader:v,side:c,uniforms:{uTime:{value:0},uResolution:{value:new m(this.sizes.width,this.sizes.height)},uNoiseScale:{value:.3},uNoiseStrength:{value:.35},uAnimationSpeed:{value:.5},uGrainIntensity:{value:.03},uVignetteStrength:{value:3},uPaletteA:{value:new a(.9,.65,1)},uPaletteB:{value:new a(.5,.5,.5)},uPaletteC:{value:new a(1,.7,.4)},uPaletteD:{value:new a(0,.15,.2)}}}),this.mesh=new g(this.geometry,this.material),this.scene.add(this.mesh)}initRenderer(){this.renderer=new f({canvas:this.canvas,antialias:!0,alpha:!0}),this.renderer.setSize(this.sizes.width,this.sizes.height),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2))}initControls(){this.controls=new w(this.camera,this.canvas),this.controls.enableDamping=!0,this.controls.enabled=!1}initEventListeners(){this.resizeObserver=new ResizeObserver(()=>this.handleResize()),this.resizeObserver.observe(this.container)}initGUI(){this.gui=new P({width:300});const e=this.gui.addFolder("Animation");e.close(),e.add(this.material.uniforms.uAnimationSpeed,"value").min(0).max(.5).step(.01).name("Speed");const t=this.gui.addFolder("Noise");t.close(),t.add(this.material.uniforms.uNoiseScale,"value").min(.1).max(3).step(.1).name("Scale"),t.add(this.material.uniforms.uNoiseStrength,"value").min(0).max(1).step(.05).name("Strength")}handleResize(){const e=this.container.getBoundingClientRect();this.sizes.width=e.width,this.sizes.height=e.height,this.camera.aspect=this.sizes.width/this.sizes.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.sizes.width,this.sizes.height),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.material.uniforms.uResolution.value.set(this.sizes.width,this.sizes.height);const t=this.camera.position.z,i=this.camera.fov*Math.PI/180,s=2*Math.tan(i/2)*t,h=s*this.camera.aspect;this.geometry.dispose(),this.geometry=new n(h,s,32,32),this.mesh.geometry=this.geometry}applyPresetImmediate(e){const t=this.material.uniforms;Object.keys(e.uniforms).forEach(i=>{const s=e.uniforms[i];s instanceof a?t[i].value.copy(s):t[i].value=s}),this.transition=null}setPreset(e){const t=Math.max(0,Math.min(e,this.presets.length-1));this.currentPresetIndex=t,this.applyPresetImmediate(this.presets[t])}setColors(e){const t=this.material.uniforms;e.paletteA&&t.uPaletteA.value.set(e.paletteA[0],e.paletteA[1],e.paletteA[2]),e.paletteB&&t.uPaletteB.value.set(e.paletteB[0],e.paletteB[1],e.paletteB[2]),e.paletteC&&t.uPaletteC.value.set(e.paletteC[0],e.paletteC[1],e.paletteC[2]),e.paletteD&&t.uPaletteD.value.set(e.paletteD[0],e.paletteD[1],e.paletteD[2])}setConfig(e){const t=this.material.uniforms;e.noiseScale!==void 0&&(t.uNoiseScale.value=e.noiseScale),e.noiseStrength!==void 0&&(t.uNoiseStrength.value=e.noiseStrength),e.animationSpeed!==void 0&&(t.uAnimationSpeed.value=e.animationSpeed),e.grainIntensity!==void 0&&(t.uGrainIntensity.value=e.grainIntensity),e.vignetteStrength!==void 0&&(t.uVignetteStrength.value=e.vignetteStrength)}getColors(){const e=this.material.uniforms;return{paletteA:[e.uPaletteA.value.x,e.uPaletteA.value.y,e.uPaletteA.value.z],paletteB:[e.uPaletteB.value.x,e.uPaletteB.value.y,e.uPaletteB.value.z],paletteC:[e.uPaletteC.value.x,e.uPaletteC.value.y,e.uPaletteC.value.z],paletteD:[e.uPaletteD.value.x,e.uPaletteD.value.y,e.uPaletteD.value.z]}}getConfig(){const e=this.material.uniforms;return{noiseScale:e.uNoiseScale.value,noiseStrength:e.uNoiseStrength.value,animationSpeed:e.uAnimationSpeed.value,grainIntensity:e.uGrainIntensity.value,vignetteStrength:e.uVignetteStrength.value}}animate(){const e=this.clock.getElapsedTime();this.material.uniforms.uTime.value=e,this.controls.update(),this.renderer.render(this.scene,this.camera),this.animationId=requestAnimationFrame(()=>this.animate())}startAnimationLoop(){this.animate()}destroy(){this.animationId&&cancelAnimationFrame(this.animationId),this.resizeObserver&&this.resizeObserver.disconnect(),this.gui&&this.gui.destroy(),this.geometry.dispose(),this.material.dispose(),this.renderer.dispose(),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}export{y as F};
